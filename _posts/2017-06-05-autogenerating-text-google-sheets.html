---
layout: post
title: Autogenerating report summary text using Google Sheets
author: Jono
published: true
date: 2017-06-05T20:00:00+0000
categories:
  - code
---
<p>After 8 years working in a marketing company I came to the conclusion that writing monthly reports for management can get tedious - it's absolutely necessary to report KPI's to management but so much of the actual writing is just based on rules and can be susceptible to copy and paste errors. Thanks to the wonders of <a href="https://docs.google.com/spreadsheets/u/0/">Google Sheets</a> much of a summary statement for a report can be autogenerated via simple 'if' and formulas statements.</p>

<p>Formula to output the name and year of last month (i.e. the last full month before the month that you are in):</p>
<code>=text(EOMONTH(TODAY(),-2)+1,"MMMM yyy")</code>

<p>Formula to output the name and year of the month before last:</p>
<code>=text(EOMONTH(TODAY(),-3)+1,"MMMM yyy")</code>

<p>Formula for formatting a number into comma separated text:</p>
<code>=text(A1,"#,###")</code>

<p>Formula for stating if this month has seen an increase or decrease in traffic:</p>
<code>=if(A2>A1,"increase","decrease")</code>

<p>Formula for showing the month-on-month change as a percentage (and only show this as a positive to tie in with the increase/decrease statement before):</p>
<code>=text(abs(((A2-A1)/A1)),"#%")</code>

<p>Extract the domain name from a full URL/page path: </p>
<p><a href="https://github.com/chrisle/seer.js/blob/master/build/seer.js">Source</a></p>
<code>function getDomainName (urlRange) {
  urlRange = strToArray(urlRange);
  var regex, returnValue = [];
  for (var i = 0; i < urlRange.length; i++) {
    url = urlRange[i];
    regex = new RegExp(/((www)\.)?.*(\w+)\.([\w\.]{2,6})/);
    returnValue.push([regex.exec(url)[0]
                     .replace(/^http(s)?:\/\//i, "")
                     .replace(/^www\./i, "")
                     .replace(/\/.*$/, "")]);
  }
  return returnValue;
}

function strToArray(obj) {
  if (typeof obj == "string") {
    return [obj];
  } else {
    return obj;
  }
}</code>
